---
layout: tutorial
title: Seiso API v1 Tutorial
docs_class: active
---
<div class="page-header">
  <h1>
    Seiso API v1 Tutorial<br>
    <small>0.2.0.SNAPSHOT</small>
  </h1>
  <div class="lead">Willie Wheeler</div>
</div>

<a id="overview"></a>
<section>
  <header>
    <h1>1 Overview</h1>
  </header>
  <p>This tutorial explains how to use the API in a hands-on way. You can use any REST client you like. Here we'll use trusty old <tt>curl</tt> along with <tt>jsonlint</tt> for formatting purposes.</p>
  <p>We assume that you've already set everything up, including the sample data. The examples below are <em>not</em> exactly from the sample data (it's a TODO for me to update them), but it should be easy enough to figure out how to apply them to the sample data, or to real data if you're using that.</p>
</section>

<a id="get-items" class="anchor"></a>
<section>
  <header>
    <h1>2 Get items</h1>
  </header>
  <p>The first thing we want to do is grab some data out of the API. Since services are the main item type, let's get the list of services. Here's how:</p>
  <pre class="shell">$ curl -H "Accept: application/json" \
> https://seiso.example.com/v1/services \
> | jsonlint</pre>
  <p>Note that we used the <code>Accept: application/json</code> request header to tell the API that we want a JSON response. The API supports only JSON output; see <a href="{{ site.baseurl }}/faqs/#faq-xml">this FAQ</a> for more information.</p>
  <p>The result looks like this:</p>
  <pre class="shell">[
  {
    "_self": "https://seiso.example.com/v1/services/seiso-db",
    "description": "Database for configuration management data",
    "group": {
      "_self": "https://seiso.example.com/v1/service-groups/devops",
      "key": "devops",
      "name": "Devops"
    },
    "key": "seiso-db",
    "name": "Seiso Database",
    "owner": ... owner data ...
    "platform": "MySQL 5.6.17",
    "scmRepository": null,
    "type": {
      "_self": "https://seiso.example.com/v1/service-types/database",
      "key": "database",
      "name": "Database"
    }
  },

  ... other services ...
]</pre>

  <p>If we want to get a single service, then we can do that by appending the service's unique key to the URI as follows:</p>
  <pre class="shell">$ curl -H "Accept: application/json" \
> https://seiso.example.com/v1/services/seiso-db \
> | jsonlint</pre>

  <p>This time the result is a single service:</p>
  
  <pre class="shell">{
  "_self": "https://seiso.example.com/v1/services/seiso-db",
  "description": "Database for configuration management data",
  "group": {
    "_self": "https://seiso.example.com/v1/service-groups/devops",
    "key": "devops",
    "name": "Devops"
  },
  "key": "seiso-db",
  "name": "Seiso Database",
  "owner": ... owner data ...
  "platform": "MySQL 5.6.17",
  "scmRepository": null,
  "type": {
    "_self": "https://seiso.example.com/v1/service-types/database",
    "key": "database",
    "name": "Database"
  }
}</pre>

  <p>Now let's see how to create a new service.</p>
</section>

<a id="create-items" class="anchor"></a>
<section>
  <header>
    <h1>3 Create items</h1>
  </header>
  <p>In general the API uses HTTP <code>PUT</code> for both creating new items and updating existing items. The reason is that the item URIs use meaningful keys as opposed to using arbitrary database identifiers. For example, a person URI looks like this:</p>
  
  <pre>https://seiso.example.com/v1/people/wwheeler</pre>
  
  <p>and <em>not</em> like this:</p>
  
  <pre>https://seiso.example.com/v1/people/14</pre>
  
  <p>Because we know the item URI in advance of creating it, we use <code>PUT</code>.</p>
  <p>To create a new service with <tt>curl</tt>, we begin by putting the JSON data in a JSON file, which for the sake of example we'll call <tt>super-search-engine.json</tt>:</p>
  
  <pre>{
  "key": "super-search-engine",
  "name": "Super Search Engine",
  "description": "A wonderful new search engine",
  "group": {
    "_self": "https://seiso.example.com/v1/service-groups/devops",
    "key": "devops" <span class="label label-info">TEMPORARY</span>
  },
  "type": {
    "_self": "https://seiso.example.com/v1/service-types/application",
    "key": "application" <span class="label label-info">TEMPORARY</span>
  }
}</pre>

  <p>There are a few points worth highlighting here.</p>

  <ul>
    <li>For the top-level object (i.e., the service that we're creating), we didn't provide a <code>_self</code> property. It's not needed because we're going to make a <code>PUT</code> request to the URI in question.</li>
    <li>In this example we've omitted a number of properties, such as <code>owner</code> and <code>scmRepository</code>. The API will treat omitted properties as having <code>null</code> values.</li>
    <li>When specifying properties whose values are objects in their own right, like <code>group</code> and <code>type</code>, we provide a <em>reference</em> to the object, as opposed to providing the entire object. We do this by specifying the object's <code>_self</code> link.</li>
  </ul>

  <blockquote>
    <p>Regarding the <span class="label label-info">TEMPORARY</span> labels: in the current implementation we build references by specifying keys rather than by providing the <code>_self</code> link. The plan is to switch over to <code>_self</code> links in the very near future. To be safe you can use both the <code>_self</code> link and the key.</p>
  </blockquote>

  <p>Now that we have <tt>super-search-engine.json</tt>, we can issue a <tt>curl</tt> command to create the service:</p>

  <pre class="shell">$ curl -X PUT \
> -H "Content-Type: application/json" \
> -d @super-search-engine.json \
> https://seiso.example.com/v1/services/super-search-engine</pre>

  <p>This type we used <code>Content-Type: application/json</code> to tell the API that we're submitting JSON. Assuming that the object is in fact new, the result will be HTTP <code>201 Created</code>.</p>

  <blockquote>
    <p>Though we didn't indicate it above, currently <code>PUT</code> requests require basic authentication. If you're using the sample data, you can use username <b>seiso-user</b> and password <b>seiso</b>. We're still working through our approach to authentication and authorization, and we'll update the documentation as we have more information.</p>
  </blockquote>
</section>

<a id="update-items" class="anchor"></a>
<section>
  <header>
    <h1>4 Update items</h1>
  </header>
  <p>Updating items is pretty much the same as creating them: you just do a <code>PUT</code> request to the relevant URI and pass the JSON data in the payload. The API returns HTTP <code>204 No Content</code> when the request is successful.</p>
  <p>Note that REST semantics dictate that <code>PUT</code> completely replaces whatever was already there.</p>
  <p>Try changing the description in the JSON:</p>
  
  <pre>{
  "key": "super-search-engine",
  "name": "Super Search Engine",
  "description": "A search engine that we like to think of as Google on steroids",
  "group": {
    "_self": "https://seiso.example.com/v1/service-groups/devops",
    "key": "devops" <span class="label label-info">TEMPORARY</span>
  },
  "type": {
    "_self": "https://seiso.example.com/v1/service-types/application",
    "key": "application" <span class="label label-info">TEMPORARY</span>
  }
}</pre>

  <p>Then just <tt>curl</tt> it in:</p>
  
  <pre class="shell">$ curl -X PUT \
> -H "Content-Type: application/json" \
> -d @super-search-engine.json \
> https://seiso.example.com/v1/services/super-search-engine</pre>
  
  <p>Finally <code>GET</code> the updated item:</p>
  
  <pre class="shell">$ curl -H "Accept: application/json" \
> https://seiso.example.com/v1/services/seiso-db \
> | jsonlint</pre>

  <p>You should see the updated description.</p>
</section>

<a id="delete-items" class="anchor"></a>
<section>
  <header>
    <h1>5 Delete items</h1>
  </header>

  <p>Alas, leadership cut funding to our Google competitor, and so it's time to delete Super Search Engine. It's exactly what you would expect:</p>

  <pre class="shell">$ curl -X DELETE https://seiso.example.com/v1/services/super-search-engine</pre>
</section>

<p>That's it for our tutorial. See the <a href="{{ site.baseurl }}/docs/current/api-reference/">Seiso v1 API Reference</a> for more detailed information on using the API.</p>
